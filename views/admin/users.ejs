<% layout('layouts/boilerplate') %>


<h1 class="title mt-3 mb-6">Users</h1>

<% if(!users.length) { %>
    <div class="notification">
        There are no requests at the moment.
      </div>
<% } else { %>

<table class="table is-fullwidth is-striped">
    <thead>
        <tr>
            <th>Username</th>
            <th>Email</th>
            <th>Roles</th>
            <th class="is-narrow">Change roles</th>
            <th class="is-narrow">Delete</th>
        </tr>
    </thead>
    <tbody>
        <% for(let user of users) { %>
            <div id="delete-modal" class="modal">
                <div class="modal-background"></div>
                <div class="modal-content">
                  <!-- Any other Bulma elements you want -->
                  <div class="notification is-danger">
                    <p>Are you sure you want to delete this user:</p>
                    <p class="is-size-4 mt-2"><strong><%= user.username %></strong></p>
                    <div class="buttons mt-5">
                        <form action="/admin/users/<%= user._id %>?_method=DELETE" method="POST" class="mr-2">
                            <button class="button is-dark">Yes</button>
                        </form>
                        <button class="button is-light modal-close-btn">No</button>
                    </div>
                  </div>
                </div>
                <button id="delete-modal-close" class="modal-close is-large modal-close-btn" aria-label="close"></button>
              </div>
                <tr>
                    <td><%= user.username %></td>
                    <td><%= user.email %></td>
                    <td>
                        <% if(user.roles && user.roles.length > 0) {
                            for(let role of user.roles) { %>
                                <%= role %><br>
                            <% }
                        } else { %>
                            None
                        <% } %>
                    </td>
                    <td class="is-narrow">
                        <a href="/admin/users/<%= user._id %>" class="button">
                            <span class="icon">
                                <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                    <path fill="currentColor" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z" />
                                </svg>
                            </span>
                        </a>
                    </td>
                    <td class="is-narrow">
                        <a href="/admin/users/<%= user._id %>/delete" class="button is-danger">
                            <span class="icon">
                                <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                    <path fill="#fff" d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" />
                                </svg>
                            </span>
                        </a>
                    </td>
                </tr>
        <% } %>
    </tbody>
</table>
<% } %>